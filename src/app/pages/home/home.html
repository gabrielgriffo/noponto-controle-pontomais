<!-- Cabeçalho da aplicação -->
<header class="header">
  <!-- Logo e branding -->
  <div class="header-left">
    <div class="logo-container">
      <div class="i icon-foco"></div>
      <span class="logo-text">No Ponto</span>
    </div>
  </div>
  <!-- Botões de controle da janela -->
  <div class="header-right">
    <!-- Botão de configurações -->
    <button class="icon-button settings" (click)="onSettingsClick()">
      <span class="icon-settings"></span>
    </button>
    <!-- Botão minimizar -->
    <button class="icon-button minimize" (click)="onMinimizeClick()" 
      tooltipPosition="bottom"
      appTooltip="Minimizar">
      <span class="icon-minimize"></span>
    </button>
    <!-- Botão fechar -->
    <button class="icon-button close" (click)="onCloseClick()"
      tooltipPosition="bottom"
      appTooltip="Fechar">
      <span class="icon-close"></span>
    </button>
  </div>
</header>

<!-- Conteúdo principal -->
<main class="main-content">
  <!-- Seção de entrada de horários e ações -->
  <section class="time-actions">
    <!-- Inputs de horário -->
    <div class="time-inputs">

      <!-- Primeira Entrada -->
      <div class="time-entry" [class.error]="checkInError">
        <label for="checkIn" class="time-label">Entrada</label>
        <div class="time-input">
          <div class="form">
            <input class="input" id="checkIn" placeholder="HH:MM" type="text" autocomplete="off"
              maxlength="5" appTimeInput #checkInInput />
          </div>
        </div>
      </div>
      <!-- Primeira Saída -->
      <div class="time-entry" [class.error]="checkOutError">
        <label for="checkOut" class="time-label">Saída</label>
        <div class="time-input">
          <div class="form">
            <input class="input" id="checkOut" placeholder="HH:MM" type="text" autocomplete="off"
              maxlength="5" appTimeInput #checkOutInput />
          </div>
        </div>
      </div>
      <!-- Segunda Entrada -->
      <div class="time-entry" [class.error]="checkIn2Error">
        <label for="checkIn2" class="time-label">Entrada</label>
        <div class="time-input">
          <div class="form">
            <input class="input" id="checkIn2" placeholder="HH:MM" type="text" autocomplete="off"
              maxlength="5" appTimeInput #checkIn2Input />
          </div>
        </div>
      </div>
    </div>

    <!-- Botões de ação -->
    <div class="action-buttons">
      <!-- Botão de importar horários -->
      <button class="btn-secondary" (click)="onImportClick()">
        Importar
        <span class="icon-download"></span>
      </button>
      <!-- Botão de iniciar monitoramento -->
      <button class="btn-primary" (click)="onStartMonitoringClick()">
        Iniciar Monitoramento
        <span class="icon-bell"></span>
      </button>
    </div>
  </section>

  <!-- Container de métricas -->
  <div class="metrics-container">
    <!-- Métrica principal: Tempo Restante -->
    <section class="metrics-section">
      <div class="metrics-line">
        <div class="metric-focus">
          <div class="metric-label">Tempo Restante</div>
          <div class="metric-focus-value">
            <app-flip-text [text]="remainingTime | timeFormat:'duration'" [fontSize]="48" [grayPrefix]="'00h'"></app-flip-text>
          </div>
        </div>
      </div>
    </section>

    <!-- Barra de progresso do expediente -->
    <section class="progress-section">
      <div class="progress-title">Progresso Total do Expediente</div>
      <div class="progress-content">
        <div class="progress-bar">
          <div class="progress-fill animated" [style.width.%]="progressPercentageValue"></div>
        </div>
        <span class="progress-percentage">{{ progressPercentageValue.toFixed(1).replace('.', ',') }}%</span>
      </div>
    </section>

    <!-- Visualização dos períodos de trabalho -->
    <section class="work-periods">
      <div class="work-periods-title">Períodos de Trabalho</div>
      <div class="periods-container">
        <div class="periods-back-bar">
          <!-- Primeiro período (entrada até saída) -->
          <div class="period-item" [style.width.%]="firstPeriodPercentage" *ngIf="isMonitoring && hasFirstPeriod">
            <div class="period-bar" [ngClass]="hasSecondPeriod ? 'period-ended' : 'period-green animated'"></div>
            <span class="period-label">{{ firstPeriodTime | timeFormat:'duration' }}</span>
          </div>
          <!-- Segundo período (retorno até agora/fim) -->
          <div class="period-item" [style.width.%]="secondPeriodPercentage" *ngIf="isMonitoring && hasSecondPeriod">
            <div class="period-bar period-green animated"></div>
            <span class="period-label">{{ secondPeriodTime | timeFormat:'duration' }}</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Métricas complementares -->
    <section class="metrics-section">
      <div class="metrics-line">
        <!-- Cartão: Tempo Trabalhado -->
        <div class="metric-card">
          <div class="metric-label">Tempo Trabalhado</div>
          <div class="metric-value">
            <app-flip-text [text]="workedTime | timeFormat:'duration'" [fontSize]="18" [grayPrefix]="'00h'"></app-flip-text>
          </div>
        </div>
        <!-- Cartão: Fim do Expediente -->
        <div class="metric-card">
          <div class="metric-label">Fim do Expediente</div>
          <div class="metric-value-ended">{{ endTime | timeFormat:'clock' }}</div>
        </div>
      </div>
    </section>

    <!-- Estado vazio (quando não está monitorando) -->
    <div class="metrics-empty-state" *ngIf="!isMonitoring">
      <div class="empty-state-content">
        <p class="empty-state-text">Insira os horários e <span class="highlight-green">inicie o monitoramento</span> para visualizar suas métricas.</p>
      </div>
    </div>
  </div>

  <!-- Rodapé com status do sistema -->
  <section class="status-footer">
    <!-- Status: Importação Automática -->
    <div class="status-item"
         appTooltip="Sincronização automática com PontoMais a cada 10 minutos"
         tooltipPosition="top">
      <span class="status-label">Importação Automática</span>
      <span class="status-value success">10m</span>
    </div>
    <!-- Status: Alarme -->
    <div class="status-item"
         appTooltip="Notificação sonora quando faltar tempo para o fim do expediente Notificação sonora quando faltar tempo para o fim do expediente"
         tooltipPosition="top">
      <span class="status-label">Alarme</span>
      <span class="status-value success">Ok</span>
    </div>
    <!-- Status: Notificação -->
    <div class="status-item"
         appTooltip="Notificações do sistema para lembretes de ponto"
         tooltipPosition="top">
      <span class="status-label">Notificação</span>
      <span class="status-value disabled">Desativada</span>
    </div>
    <!-- Status: Conexão com PontoMais -->
    <div class="status-item"
         appTooltip="Status da conexão com o sistema PontoMais"
         tooltipPosition="top">
      <span class="status-label">Conexão com PontoMais</span>
      <span class="status-value success">Ok</span>
    </div>
  </section>
</main>

<!-- Modal de Configurações -->
<app-settings-modal [isOpen]="showSettingsModal" (close)="onCloseSettingsModal()"></app-settings-modal>